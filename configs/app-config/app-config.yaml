# This is the default rhdh-local config, and any user configuration should be added app-config.local.yaml instead
auth:
  environment: development
  providers:
    guest:
      dangerouslyAllowOutsideDevelopment: true
    # github:
    #   development:
    #     clientId: ${AUTH_GITHUB_CLIENT_ID}
    #     clientSecret: ${AUTH_GITHUB_CLIENT_SECRET}

# integrations:
#   github:
#     - host: github.com
#       apps:
#         - $include: ../extra-files/github-app-credentials.yaml

app:
  title: Red Hat Developer Hub
  baseUrl: ${BASE_URL}
  branding:
    # If using a different logo, replace these lines with your own image(s)
    # fullLogo: data:image/svg+xml;base64,your-image-goes-here==
    # - or -
    # fullLogo: 
    #   dark: data:image/svg+xml;base64,your-image-in-dark-mode-goes-here==
    #   light: data:image/svg+xml;base64,your-image-in-light-mode-goes-here==
    # iconLogo: data:image/svg+xml;base64,your-image-goes-here==
    fullLogoWidth: ${FULL_LOGO_WIDTH}
    theme:
      light:
        primaryColor: ${PRIMARY_LIGHT_COLOR}
        headerColor1: ${HEADER_LIGHT_COLOR_1}
        headerColor2: ${HEADER_LIGHT_COLOR_2}
        navigationIndicatorColor: ${NAV_INDICATOR_LIGHT_COLOR}
      dark:
        primaryColor: ${PRIMARY_DARK_COLOR}
        headerColor1: ${HEADER_DARK_COLOR_1}
        headerColor2: ${HEADER_DARK_COLOR_2}
        navigationIndicatorColor: ${NAV_INDICATOR_DARK_COLOR}
backend:
  listen:
    port: 7007
  baseUrl: ${BASE_URL}
  # uncomment this if backend.baseUrl is exposed over HTTPS
  # and you want RHDH to auto-generate and serve a self-signed certificate.
  # https: true
  cors:
    origin: ${BASE_URL}
    methods: [GET, HEAD, PATCH, POST, PUT, DELETE]
    credentials: true
  csp:
   upgrade-insecure-requests: false
   # CSP for Quay Images
   img-src:
    - "'self'"
    - "data:"
    - "https://quay.io"
    - "https://*.quay.io"
# comment out the following 'database' section to use the PostgreSQL database
  database:
    client: better-sqlite3
    connection: ':memory:'

  auth:
    keys:
      - secret: "development"

#Â You can use local files from catalog-entities directory to load entities into the catalog
catalog:
  # Processing interval for catalog refresh rates - 30 seconds - uncomment to use
  # processingInterval: { seconds: 30 }

  rules:
    - allow: [Component, API, Location, Template, Domain, User, Group, System, Resource]

  locations:
    - type: file
      target: /opt/app-root/src/catalog-info.yaml
    - type: file
      target: /opt/app-root/src/configs/catalog-entities/users.yaml
      rules:
        - allow: [User, Group]
    - type: file
      target: /opt/app-root/src/configs/catalog-entities/components.override.yaml
    # Load Frontend Dynamic Plugin Software Template.
    # Using this template in RHDH requires GitHub integration to be set up.
    - type: url
      target: https://github.com/redhat-developer/red-hat-developer-hub-software-templates/blob/main/templates/create-frontend-plugin/template.yaml
      rules:
        - allow: [Template]
    # Load Backend Dynamic Plugin Software Template.
    # Using this template in RHDH requires GitHub integration to be set up.
    - type: url
      target: https://github.com/redhat-developer/red-hat-developer-hub-software-templates/blob/main/templates/create-backend-plugin/template.yaml
      rules:
        - allow: [Template]
    # Load 'Create Tech Docs' Software Template
    # Using this template in RHDH requires GitHub integration to be set up.
    - type: url
      target: https://github.com/redhat-developer/red-hat-developer-hub-software-templates/blob/main/templates/github/techdocs/template.yaml
      rules:
        - allow: [Template]
    # Load 'Register Existing Component to Catalog' Software Template.
    # Using this template in RHDH requires GitHub integration to be set up.
    - type: url
      target: https://github.com/redhat-developer/red-hat-developer-hub-software-templates/blob/main/templates/github/register-component/template.yaml
      rules:
        - allow: [Template]
    # - type: url
    #   target: https://github.com/backstage/backstage/blob/master/packages/catalog-model/examples/all.yaml
    #   rules:
    #     - allow: [Component, User, Group, Domain]

techdocs:
  generator:
    runIn: local
  builder: local
  publisher:
    type: local
    local:
      publishDirectory: /tmp/techdocs

dynamicPlugins:
  frontend:
    default.main-menu-items:
        menuItems:
          default.help:
            title: RHDH Local Guide
            icon: help
            priority: 5
            to: /catalog/default/system/rhdh-local/docs
            enabled: true

proxy:
  endpoints:
    '/quay/api':
      target: 'https://quay.io'
      credentials: require
      headers:
        X-Requested-With: 'XMLHttpRequest'
        # Uncomment and use the Authorization header below to access a private Quay
        # Repository using a token. Refer to the "Applications and Tokens" section
        # at https://docs.quay.io/api/ to find the instructions to generate a token
        # Authorization: 'Bearer <YOUR TOKEN>'
      changeOrigin: true
      # Change to "false" in case of using self hosted quay instance with a self-signed certificate
      secure: true

quay:
  # The UI url for Quay, used to generate the link to Quay
  uiUrl: 'https://quay.io'
